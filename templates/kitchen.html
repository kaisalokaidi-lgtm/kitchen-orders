<!DOCTYPE html>
<html>
<head>
    <title>Kitchen</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container py-5">
<h2>ğŸ‘¨â€ğŸ³ Kitchen Orders</h2>
<table class="table mt-4">
<thead>
<tr><th>Name</th><th>Options</th><th>Status</th><th></th></tr>
</thead>
<tbody id="orders"></tbody>
</table>
<script>
const OPTION_LABELS = {
    "tomateos": "tomateos ğŸ…",
    "saute_onions": "saute onions ğŸ§…",
    "gherkins": "gherkins ğŸ¥’",
    "jalapeno": "jalapeno ğŸŒ¶ï¸",
    "cheese": "cheese ğŸ§€",
    "lettuce": "lettuce ğŸ¥¬",
    "chefs_special": "chefs special ğŸ‘¨â€ğŸ³",
    "peri_peri_lemon_and_herb": "peri peri lemon and herb ğŸ‹ğŸŒ¿",
    "burger_sauce": "burger sauce ğŸ¥«",
    "ketchup": "ketchup ğŸ…",
    "bbq": "BBQ ğŸ”¥",
    "mayo": "mayo ğŸ§´",
    "peri_peri_medium": "peri peri medium ğŸŒ¶ï¸"
};

async function loadOrders() {
    const res = await fetch("/api/orders");
    const orders = await res.json();
    const tbody = document.getElementById("orders");
    tbody.innerHTML = "";
    orders.forEach(o => {
        // build badges for selected options (CSV stores "True"/"False")
        const badges = Object.keys(OPTION_LABELS).filter(k => o[k] === "True").map(k =>
            `<span class="badge bg-secondary me-1">${OPTION_LABELS[k]}</span>`
        ).join("");
        tbody.innerHTML += `
        <tr>
            <td>${o.name}</td>
            <td>${badges || "â€”"}</td>
            <td>${o.status}</td>
            <td>${o.status === "pending" ? `<button class="btn btn-success btn-sm" onclick="markReady(${o.id})">Ready</button>` : ""}</td>
        </tr>`;
    });
}
async function markReady(id) {
    await fetch(`/api/orders/${id}/ready`, { method: "POST" });
    loadOrders();
}
loadOrders();
setInterval(loadOrders, 2000);
</script>
</body>
</html>
